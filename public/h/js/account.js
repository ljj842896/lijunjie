var accountGuy={};!function(e){var t={required:function(e){return e.length},phone:function(e){return/^(13|14|15|17|18|19|16)\d{9}$/.test(e)},email:function(e){var t=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;return t.test(e)},url:function(e){return/^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-~]+)\.)+([A-Za-z0-9-~\/])+$/.test(e)},number:function(e){return/^\d+$/.test(e)}},o={required:"该项为必填项",phone:"请正确填写手机号码",email:"请正确填写电子邮箱",url:"请正确填写url地址",number:"请填写数字"},i=function(e){this.eleName=e.eleName,this.ele=$("[name="+e.eleName+"]"),this.eleRole=e.eleRole,this.eleForm=e.eleForm,this.triggerType=this.eleForm.triggerType,this.messageCallback=this.eleForm.messageCallback,this.messagePosition=this.eleForm.messagePosition(this.ele),this.qualified=!1,this.init()};i.prototype={init:function(){var e=this;"blur"==e.triggerType&&e.ele.on("blur",function(){e.checkout()}),e.ele.on("input",function(){""===e.ele.val()&&e.packMessage()}).on("focus",function(){""===e.ele.val()&&e.packMessage()})},isWrong:function(){this.qualified=!1},isRight:function(){this.qualified=!0},checkout:function(){for(var e=this,o=!1,i=0;i<e.eleRole.length;i++)if("required"==e.eleRole[i].role&&(o=!0,!t[e.eleRole[i].role](e.ele.val())))return e.showMessage(e.eleRole[i].role,e.eleRole[i].message),e.isWrong(),e.qualified;if(""===e.ele.val()&&!o)return e.isRight(),e.qualified;for(var n=0;n<e.eleRole.length;n++)if("required"!=e.eleRole[n].role)if(t[e.eleRole[n].role]){if(!t[e.eleRole[n].role](e.ele.val())){e.showMessage(e.eleRole[n].role,e.eleRole[n].message),e.isWrong();break}e.packMessage(),e.isRight()}else console.error("validate：[name="+e.eleName+"]请设置正确的规则名称，或添加新的规则！");return e.qualified},showMessage:function(e,t){this.messagePosition.html(t||o[e]).show(),this.messageCallback&&("function"==typeof this.messageCallback?this.messageCallback(!1,this.ele,o[e]):console.error?console.error("validate：请设置正确的错误处理函数！"):console.log("validate：请设置正确的错误处理函数！"))},packMessage:function(){this.messagePosition.html("").hide(),this.messageCallback&&("function"==typeof this.messageCallback?this.messageCallback(!0,this.ele):console.error?console.error("validate：请设置正确的错误处理函数！"):console.log("validate：请设置正确的错误处理函数！"))}};var n=function(e){this.validObj=e,this.triggerType="blur",this.autoCommit=!1,this.messageCallback=null,this.messagePosition=null,this.qualified=!1,this.sheetObj={},this.init()};n.prototype={checkout:function(){for(var e in this.sheetObj){if(!this.sheetObj[e].checkout()){this.isWrong();break}this.isRight()}return this.qualified},isWrong:function(){this.qualified=!1},isRight:function(){this.qualified=!0},commit:function(){},init:function(){var e=this;for(var t in e.validObj.config)e[t]=e.validObj.config[t];for(var o in e.validObj)"config"!=o&&(e.sheetObj[o]=new i({eleForm:e,eleName:o,eleRole:e.validObj[o]}))}},e.accountGuy.BYvalidate={createValid:function(e){if(e.config.messagePosition||e.config.messageCallback){var t=new n(e);return{valid:function(){return t.checkout(),t.qualified},commit:function(){},changeRole:function(e){for(var o in e)t.sheetObj[o]?t.sheetObj[o].eleRole=e[o]:t.sheetObj[o]=new i({eleForm:t,eleName:o,eleRole:e[o]})},validSingle:function(e){return t.sheetObj[e].checkout()}}}console.error("validate：请在config中设置错误处理机制！")},evolutionRole:function(e){for(var i=0;i<e.length;i++)e[i].roleName&&e[i].roleMessage&&e[i].roleFn?t[e[i].roleName]?console.error("validate：该规则已经存在，请作为新规则添加！"):(t[e[i].roleName]=e[i].roleFn,o[e[i].roleName]=e[i].roleMessage):console.error("validate：如需添加新规则，请传入完整规则！")}}}(this),function(e){var t=function(e,t){this.ele=$("[name="+e+"]"),this.phText=t,this.phEle=$("<s>"+t+"</s>"),this.parents=this.ele.parent(),this.isShow=!0,this.init()};t.prototype={show:function(){this.phEle.show()},hide:function(){this.phEle.hide()},init:function(){var e=this;if(void 0!==e.ele[0].placeholder)e.ele.attr("placeholder",e.phText);else{var t=function(){e.ele.val()?e.hide():e.show()};e.parents.append(e.phEle),e.ele.on("focus",function(){e.hide()}).on("blur",t),e.phEle.on("click",function(){e.ele.focus()})}}},e.accountGuy.BYplaceholder=function(e){for(var o in e)new t(o,e[o])}}(this),accountGuy.getImageCode=function(e,t){$.ajax({type:"get",url:ControllerSite+"/account/getImageCode",data:t.s?t:"",dataType:"json",success:function(t){e(t)},error:function(){e({success:0,error:{message:"网络原因获取失败，请稍后再试！"}})}})},accountGuy.getPhoneCode=function(e,t){$.ajax({type:"get",url:ControllerSite+"/account/getPhoneCode",data:t,dataType:"json",success:function(t){e(t)},error:function(){e({success:0,error:{message:"网络原因获取失败，请稍后再试！"}})}})},accountGuy.checkPhone=function(e,t){$.ajax({type:"get",url:ControllerSite+"/account/checkPhoneState",data:t,dataType:"json",success:function(t){e(t)},error:function(){e({success:0,error:{message:"网络原因获取失败，请稍后再试！"}})}})},accountGuy.getParam=function(e){for(var t,o=window.location.search.slice(1).split("&"),i=0;i<o.length;i++)o[i].split("=")[0]==e&&(t=o[i].split("=")[1]);return t},accountGuy.getReturnUrl=function(){var e=this.getParam("returnUrl");return e?(e=decodeURIComponent(e).split("#")[0],(0==e.indexOf("http://")||0==e.indexOf("https://"))&&-1==e.indexOf(".biyao.com")&&(e="http://www.biyao.com/home/index.html"),encodeURIComponent(e)):encodeURIComponent("http://www.biyao.com/home/index.html")};